{"ast":null,"code":"var _jsxFileName = \"/home/dev/Code/dex-ui/src/pages/TradePage.tsx\";\nimport { Button, Col, Popover, Row, Select, Typography } from 'antd';\nimport { DeleteOutlined, InfoCircleOutlined, PlusCircleOutlined } from '@ant-design/icons';\nimport { MarketProvider, getMarketInfos, getTradePageUrl, useMarket, useMarketsList, useUnmigratedDeprecatedMarkets } from '../utils/markets';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport CustomMarketDialog from '../components/CustomMarketDialog';\nimport DeprecatedMarketsInstructions from '../components/DeprecatedMarketsInstructions';\nimport LinkAddress from '../components/LinkAddress';\nimport Orderbook from '../components/Orderbook';\nimport StandaloneBalancesDisplay from '../components/StandaloneBalancesDisplay';\nimport { TVChartContainer } from '../components/TradingView';\nimport TradeForm from '../components/TradeForm';\nimport TradesTable from '../components/TradesTable';\nimport UserInfoTable from '../components/UserInfoTable';\nimport { notify } from '../utils/notifications';\nimport styled from 'styled-components';\nimport { nanoid } from 'nanoid';\nconst {\n  Option,\n  OptGroup\n} = Select;\nconst Wrapper = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 16px 16px;\n  .borderNone .ant-select-selector {\n    border: none !important;\n  }\n`;\nexport default function TradePage() {\n  const {\n    marketAddress\n  } = useParams();\n  useEffect(() => {\n    if (marketAddress) {\n      localStorage.setItem('marketAddress', JSON.stringify(marketAddress));\n    }\n  }, [marketAddress]);\n  const history = useHistory();\n\n  function setMarketAddress(address) {\n    history.push(getTradePageUrl(address));\n  }\n\n  return /*#__PURE__*/React.createElement(MarketProvider, {\n    marketAddress: marketAddress,\n    setMarketAddress: setMarketAddress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(TradePageInner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }));\n}\n\nfunction TradePageInner() {\n  const {\n    market,\n    marketName,\n    customMarkets,\n    setCustomMarkets,\n    setMarketAddress\n  } = useMarket(); // const markets = useMarketsList();\n\n  const [handleDeprecated, setHandleDeprecated] = useState(false);\n  const [addMarketVisible, setAddMarketVisible] = useState(false);\n  const deprecatedMarkets = useUnmigratedDeprecatedMarkets(); // const [dimensions, setDimensions] = useState({\n\n  const [dimensions] = useState({\n    height: window.innerHeight,\n    width: window.innerWidth\n  });\n  useEffect(() => {\n    document.title = marketName ? `${marketName} — Raydium` : 'Raydium';\n  }, [marketName]);\n  const changeOrderRef = useRef(); // useEffect(() => {\n  //   const handleResize = () => {\n  //     setDimensions({\n  //       height: window.innerHeight,\n  //       width: window.innerWidth,\n  //     });\n  //   };\n  //   window.addEventListener('resize', handleResize);\n  //   return () => window.removeEventListener('resize', handleResize);\n  // }, []);\n\n  const width = dimensions === null || dimensions === void 0 ? void 0 : dimensions.width;\n  const componentProps = {\n    onChangeOrderRef: ref => changeOrderRef.current = ref,\n    onPrice: useCallback(price => changeOrderRef.current && changeOrderRef.current({\n      price\n    }), []),\n    onSize: useCallback(size => changeOrderRef.current && changeOrderRef.current({\n      size\n    }), [])\n  };\n\n  const component = (() => {\n    if (handleDeprecated) {\n      return /*#__PURE__*/React.createElement(DeprecatedMarketsPage, {\n        switchToLiveMarkets: () => setHandleDeprecated(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 9\n        }\n      });\n    } else if (width < 1000) {\n      return /*#__PURE__*/React.createElement(RenderSmaller, Object.assign({}, componentProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 14\n        }\n      }));\n    } else {\n      return /*#__PURE__*/React.createElement(RenderNormal, Object.assign({}, componentProps, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 14\n        }\n      }));\n    }\n  })();\n\n  const onAddCustomMarket = customMarket => {\n    const marketInfo = getMarketInfos(customMarkets).some(m => m.address.toBase58() === customMarket.address);\n\n    if (marketInfo) {\n      notify({\n        message: `A market with the given ID already exists`,\n        type: 'error'\n      });\n      return;\n    }\n\n    const newCustomMarkets = [...customMarkets, customMarket];\n    setCustomMarkets(newCustomMarkets);\n    setMarketAddress(customMarket.address);\n  };\n\n  const onDeleteCustomMarket = address => {\n    const newCustomMarkets = customMarkets.filter(m => m.address !== address);\n    setCustomMarkets(newCustomMarkets);\n  }; // const [newMarKets] = useState(markets);\n\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CustomMarketDialog, {\n    visible: addMarketVisible,\n    onClose: () => setAddMarketVisible(false),\n    onAddCustomMarket: onAddCustomMarket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Wrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    align: \"middle\",\n    style: {\n      paddingLeft: 5,\n      paddingRight: 5\n    },\n    gutter: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MarketSelector, {\n    markets: useMarketsList(),\n    setHandleDeprecated: setHandleDeprecated,\n    placeholder: 'Select market',\n    customMarkets: customMarkets,\n    onDeleteCustomMarket: onDeleteCustomMarket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }\n  })), market ? /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Popover, {\n    content: /*#__PURE__*/React.createElement(LinkAddress, {\n      address: market.publicKey.toBase58(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 26\n      }\n    }),\n    placement: \"bottomRight\",\n    title: \"Market address\",\n    trigger: \"click\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(InfoCircleOutlined, {\n    style: {\n      color: '#2abdd2'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }))) : null, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(PlusCircleOutlined, {\n    style: {\n      color: '#2abdd2'\n    },\n    onClick: () => setAddMarketVisible(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }\n  })), deprecatedMarkets && deprecatedMarkets.length > 0 && /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }, \"You have unsettled funds on old markets! Please go through them to claim your funds.\")), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: () => setHandleDeprecated(!handleDeprecated),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 17\n    }\n  }, handleDeprecated ? 'View new markets' : 'Handle old markets')))), component));\n}\n\nfunction MarketSelector({\n  markets,\n  placeholder,\n  setHandleDeprecated,\n  customMarkets,\n  onDeleteCustomMarket\n}) {\n  var _getMarketInfos$find, _getMarketInfos$find$;\n\n  const {\n    market,\n    setMarketAddress\n  } = useMarket();\n\n  const onSetMarketAddress = marketAddress => {\n    setHandleDeprecated(false);\n    setMarketAddress(marketAddress);\n  };\n\n  const selectedMarket = (_getMarketInfos$find = getMarketInfos(customMarkets).find(proposedMarket => (market === null || market === void 0 ? void 0 : market.address) && proposedMarket.address.equals(market.address))) === null || _getMarketInfos$find === void 0 ? void 0 : (_getMarketInfos$find$ = _getMarketInfos$find.address) === null || _getMarketInfos$find$ === void 0 ? void 0 : _getMarketInfos$find$.toBase58();\n\n  const uniqueArray = arr => {\n    let addList = [];\n    let reList = [];\n\n    for (let index = 0; index < arr.length; index += 1) {\n      if (addList.indexOf(arr[index].address.toBase58()) === -1) {\n        reList.push(arr[index]);\n        addList.push(arr[index].address.toBase58());\n      }\n    }\n\n    return reList;\n  };\n\n  return /*#__PURE__*/React.createElement(Select, {\n    showSearch: true,\n    size: 'large',\n    bordered: false,\n    style: {\n      width: 200\n    },\n    placeholder: placeholder || 'Select a market',\n    optionFilterProp: \"name\",\n    onSelect: onSetMarketAddress,\n    listHeight: 400,\n    value: selectedMarket,\n    filterOption: (input, option) => {\n      var _option$name;\n\n      return (option === null || option === void 0 ? void 0 : (_option$name = option.name) === null || _option$name === void 0 ? void 0 : _option$name.toLowerCase().indexOf(input.toLowerCase())) >= 0;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 5\n    }\n  }, customMarkets && customMarkets.length > 0 && /*#__PURE__*/React.createElement(OptGroup, {\n    label: \"Custom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 9\n    }\n  }, customMarkets.map(({\n    address,\n    name\n  }, i) => /*#__PURE__*/React.createElement(Option, {\n    value: address,\n    key: nanoid(),\n    name: name,\n    style: {\n      padding: '10px',\n      // @ts-ignore\n      backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 17\n    }\n  }, name), selectedMarket !== address && /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(DeleteOutlined, {\n    onClick: e => {\n      e.stopPropagation();\n      e.nativeEvent.stopImmediatePropagation();\n      onDeleteCustomMarket && onDeleteCustomMarket(address);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 21\n    }\n  })))))), /*#__PURE__*/React.createElement(OptGroup, {\n    label: \"Markets\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }\n  }, uniqueArray(markets).map(({\n    address,\n    name,\n    deprecated\n  }, i) => /*#__PURE__*/React.createElement(Option, {\n    value: address.toBase58(),\n    key: nanoid(),\n    name: name,\n    style: {\n      padding: '10px',\n      // @ts-ignore\n      backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 11\n    }\n  }, name, \" \", deprecated ? ' (Deprecated)' : null))));\n}\n\nconst DeprecatedMarketsPage = ({\n  switchToLiveMarkets\n}) => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DeprecatedMarketsInstructions, {\n    switchToLiveMarkets: switchToLiveMarkets,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 11\n    }\n  }))));\n};\n\nconst RenderNormal = ({\n  onChangeOrderRef,\n  onPrice,\n  onSize\n}) => {\n  return /*#__PURE__*/React.createElement(Row, {\n    style: {\n      flexWrap: 'nowrap'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    flex: \"auto\",\n    style: {\n      height: '100vh',\n      display: 'flex',\n      flexDirection: 'column',\n      border: '1px solid #9945FF',\n      marginRight: '15px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TVChartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(UserInfoTable, {\n    smallScreen: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    flex: \"15%\",\n    style: {\n      height: '100vh',\n      minWidth: '280px',\n      border: '1px solid #9945FF',\n      marginRight: '15px',\n      overflow: 'hidden'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Orderbook, {\n    smallScreen: false,\n    onPrice: onPrice,\n    onSize: onSize,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(TradesTable, {\n    smallScreen: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    flex: \"400px\",\n    style: {\n      height: '100vh',\n      border: '1px solid #9945FF',\n      padding: '5px',\n      overflow: 'hidden'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TradeForm, {\n    setChangeOrderRef: onChangeOrderRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(StandaloneBalancesDisplay, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 9\n    }\n  })));\n};\n\nconst RenderSmaller = ({\n  onChangeOrderRef,\n  onPrice,\n  onSize\n}) => {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    span: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TVChartContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    span: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TradeForm, {\n    setChangeOrderRef: onChangeOrderRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    span: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Orderbook, {\n    smallScreen: true,\n    onPrice: onPrice,\n    onSize: onSize,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    span: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(UserInfoTable, {\n    smallScreen: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    xs: 24,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(StandaloneBalancesDisplay, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    xs: 24,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TradesTable, {\n    smallScreen: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 11\n    }\n  }))));\n};","map":{"version":3,"sources":["/home/dev/Code/dex-ui/src/pages/TradePage.tsx"],"names":["Button","Col","Popover","Row","Select","Typography","DeleteOutlined","InfoCircleOutlined","PlusCircleOutlined","MarketProvider","getMarketInfos","getTradePageUrl","useMarket","useMarketsList","useUnmigratedDeprecatedMarkets","React","useCallback","useEffect","useRef","useState","useHistory","useParams","CustomMarketDialog","DeprecatedMarketsInstructions","LinkAddress","Orderbook","StandaloneBalancesDisplay","TVChartContainer","TradeForm","TradesTable","UserInfoTable","notify","styled","nanoid","Option","OptGroup","Wrapper","div","TradePage","marketAddress","localStorage","setItem","JSON","stringify","history","setMarketAddress","address","push","TradePageInner","market","marketName","customMarkets","setCustomMarkets","handleDeprecated","setHandleDeprecated","addMarketVisible","setAddMarketVisible","deprecatedMarkets","dimensions","height","window","innerHeight","width","innerWidth","document","title","changeOrderRef","componentProps","onChangeOrderRef","ref","current","onPrice","price","onSize","size","component","onAddCustomMarket","customMarket","marketInfo","some","m","toBase58","message","type","newCustomMarkets","onDeleteCustomMarket","filter","paddingLeft","paddingRight","publicKey","color","length","MarketSelector","markets","placeholder","onSetMarketAddress","selectedMarket","find","proposedMarket","equals","uniqueArray","arr","addList","reList","index","indexOf","input","option","name","toLowerCase","map","i","padding","backgroundColor","e","stopPropagation","nativeEvent","stopImmediatePropagation","deprecated","DeprecatedMarketsPage","switchToLiveMarkets","RenderNormal","flexWrap","display","flexDirection","border","marginRight","minWidth","overflow","RenderSmaller"],"mappings":"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","sourcesContent":["import { Button, Col, Popover, Row, Select, Typography } from 'antd';\r\nimport {\r\n  DeleteOutlined,\r\n  InfoCircleOutlined,\r\n  PlusCircleOutlined,\r\n} from '@ant-design/icons';\r\nimport {\r\n  MarketProvider,\r\n  getMarketInfos,\r\n  getTradePageUrl,\r\n  useMarket,\r\n  useMarketsList,\r\n  useUnmigratedDeprecatedMarkets,\r\n} from '../utils/markets';\r\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\n\r\nimport CustomMarketDialog from '../components/CustomMarketDialog';\r\nimport DeprecatedMarketsInstructions from '../components/DeprecatedMarketsInstructions';\r\nimport LinkAddress from '../components/LinkAddress';\r\nimport { MarketInfo } from '../utils/types';\r\nimport Orderbook from '../components/Orderbook';\r\nimport StandaloneBalancesDisplay from '../components/StandaloneBalancesDisplay';\r\nimport { TVChartContainer } from '../components/TradingView';\r\nimport TradeForm from '../components/TradeForm';\r\nimport TradesTable from '../components/TradesTable';\r\nimport UserInfoTable from '../components/UserInfoTable';\r\nimport { notify } from '../utils/notifications';\r\nimport styled from 'styled-components';\r\nimport { nanoid } from 'nanoid';\r\n\r\nconst { Option, OptGroup } = Select;\r\n\r\nconst Wrapper = styled.div`\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 16px 16px;\r\n  .borderNone .ant-select-selector {\r\n    border: none !important;\r\n  }\r\n`;\r\n\r\nexport default function TradePage() {\r\n  const { marketAddress } = useParams();\r\n  useEffect(() => {\r\n    if (marketAddress) {\r\n      localStorage.setItem('marketAddress', JSON.stringify(marketAddress));\r\n    }\r\n  }, [marketAddress]);\r\n  const history = useHistory();\r\n  function setMarketAddress(address) {\r\n    history.push(getTradePageUrl(address));\r\n  }\r\n\r\n  return (\r\n    <MarketProvider\r\n      marketAddress={marketAddress}\r\n      setMarketAddress={setMarketAddress}\r\n    >\r\n      <TradePageInner />\r\n    </MarketProvider>\r\n  );\r\n}\r\n\r\nfunction TradePageInner() {\r\n  const {\r\n    market,\r\n    marketName,\r\n    customMarkets,\r\n    setCustomMarkets,\r\n    setMarketAddress,\r\n  } = useMarket();\r\n  // const markets = useMarketsList();\r\n  const [handleDeprecated, setHandleDeprecated] = useState(false);\r\n  const [addMarketVisible, setAddMarketVisible] = useState(false);\r\n  const deprecatedMarkets = useUnmigratedDeprecatedMarkets();\r\n  // const [dimensions, setDimensions] = useState({\r\n  const [dimensions] = useState({\r\n    height: window.innerHeight,\r\n    width: window.innerWidth,\r\n  });\r\n\r\n  useEffect(() => {\r\n    document.title = marketName ? `${marketName} — Raydium` : 'Raydium';\r\n  }, [marketName]);\r\n\r\n  const changeOrderRef =\r\n    useRef<({ size, price }: { size?: number; price?: number }) => void>();\r\n\r\n  // useEffect(() => {\r\n  //   const handleResize = () => {\r\n  //     setDimensions({\r\n  //       height: window.innerHeight,\r\n  //       width: window.innerWidth,\r\n  //     });\r\n  //   };\r\n\r\n  //   window.addEventListener('resize', handleResize);\r\n  //   return () => window.removeEventListener('resize', handleResize);\r\n  // }, []);\r\n\r\n  const width = dimensions?.width;\r\n\r\n  const componentProps = {\r\n    onChangeOrderRef: (ref) => (changeOrderRef.current = ref),\r\n    onPrice: useCallback(\r\n      (price) => changeOrderRef.current && changeOrderRef.current({ price }),\r\n      [],\r\n    ),\r\n    onSize: useCallback(\r\n      (size) => changeOrderRef.current && changeOrderRef.current({ size }),\r\n      [],\r\n    ),\r\n  };\r\n  const component = (() => {\r\n    if (handleDeprecated) {\r\n      return (\r\n        <DeprecatedMarketsPage\r\n          switchToLiveMarkets={() => setHandleDeprecated(false)}\r\n        />\r\n      );\r\n    } else if (width < 1000) {\r\n      return <RenderSmaller {...componentProps} />;\r\n    } else {\r\n      return <RenderNormal {...componentProps} />;\r\n    }\r\n  })();\r\n\r\n  const onAddCustomMarket = (customMarket) => {\r\n    const marketInfo = getMarketInfos(customMarkets).some(\r\n      (m) => m.address.toBase58() === customMarket.address,\r\n    );\r\n    if (marketInfo) {\r\n      notify({\r\n        message: `A market with the given ID already exists`,\r\n        type: 'error',\r\n      });\r\n      return;\r\n    }\r\n    const newCustomMarkets = [...customMarkets, customMarket];\r\n    setCustomMarkets(newCustomMarkets);\r\n    setMarketAddress(customMarket.address);\r\n  };\r\n\r\n  const onDeleteCustomMarket = (address) => {\r\n    const newCustomMarkets = customMarkets.filter((m) => m.address !== address);\r\n    setCustomMarkets(newCustomMarkets);\r\n  };\r\n  // const [newMarKets] = useState(markets);\r\n\r\n  return (\r\n    <>\r\n      <CustomMarketDialog\r\n        visible={addMarketVisible}\r\n        onClose={() => setAddMarketVisible(false)}\r\n        onAddCustomMarket={onAddCustomMarket}\r\n      />\r\n      <Wrapper>\r\n        <Row\r\n          align=\"middle\"\r\n          style={{ paddingLeft: 5, paddingRight: 5 }}\r\n          gutter={16}\r\n        >\r\n          <Col>\r\n            <MarketSelector\r\n              markets={useMarketsList()}\r\n              setHandleDeprecated={setHandleDeprecated}\r\n              placeholder={'Select market'}\r\n              customMarkets={customMarkets}\r\n              onDeleteCustomMarket={onDeleteCustomMarket}\r\n            />\r\n          </Col>\r\n          {market ? (\r\n            <Col>\r\n              <Popover\r\n                content={<LinkAddress address={market.publicKey.toBase58()} />}\r\n                placement=\"bottomRight\"\r\n                title=\"Market address\"\r\n                trigger=\"click\"\r\n              >\r\n                <InfoCircleOutlined style={{ color: '#2abdd2' }} />\r\n              </Popover>\r\n            </Col>\r\n          ) : null}\r\n          <Col>\r\n            <PlusCircleOutlined\r\n              style={{ color: '#2abdd2' }}\r\n              onClick={() => setAddMarketVisible(true)}\r\n            />\r\n          </Col>\r\n          {deprecatedMarkets && deprecatedMarkets.length > 0 && (\r\n            <React.Fragment>\r\n              <Col>\r\n                <Typography>\r\n                  You have unsettled funds on old markets! Please go through\r\n                  them to claim your funds.\r\n                </Typography>\r\n              </Col>\r\n              <Col>\r\n                <Button onClick={() => setHandleDeprecated(!handleDeprecated)}>\r\n                  {handleDeprecated ? 'View new markets' : 'Handle old markets'}\r\n                </Button>\r\n              </Col>\r\n            </React.Fragment>\r\n          )}\r\n        </Row>\r\n        {component}\r\n      </Wrapper>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction MarketSelector({\r\n  markets,\r\n  placeholder,\r\n  setHandleDeprecated,\r\n  customMarkets,\r\n  onDeleteCustomMarket,\r\n}) {\r\n  const { market, setMarketAddress } = useMarket();\r\n\r\n  const onSetMarketAddress = (marketAddress) => {\r\n    setHandleDeprecated(false);\r\n    setMarketAddress(marketAddress);\r\n  };\r\n\r\n  const selectedMarket = getMarketInfos(customMarkets)\r\n    .find(\r\n      (proposedMarket) =>\r\n        market?.address && proposedMarket.address.equals(market.address),\r\n    )\r\n    ?.address?.toBase58();\r\n\r\n  const uniqueArray = (arr) => {\r\n    let addList: string[] = [];\r\n    let reList: MarketInfo[] = [];\r\n    for (let index = 0; index < arr.length; index += 1) {\r\n      if (addList.indexOf(arr[index].address.toBase58()) === -1) {\r\n        reList.push(arr[index]);\r\n        addList.push(arr[index].address.toBase58());\r\n      }\r\n    }\r\n    return reList;\r\n  };\r\n\r\n  return (\r\n    <Select\r\n      showSearch\r\n      size={'large'}\r\n      bordered={false}\r\n      style={{ width: 200 }}\r\n      placeholder={placeholder || 'Select a market'}\r\n      optionFilterProp=\"name\"\r\n      onSelect={onSetMarketAddress}\r\n      listHeight={400}\r\n      value={selectedMarket}\r\n      filterOption={(input, option) =>\r\n        option?.name?.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n      }\r\n    >\r\n      {customMarkets && customMarkets.length > 0 && (\r\n        <OptGroup label=\"Custom\">\r\n          {customMarkets.map(({ address, name }, i) => (\r\n            <Option\r\n              value={address}\r\n              key={nanoid()}\r\n              name={name}\r\n              style={{\r\n                padding: '10px',\r\n                // @ts-ignore\r\n                backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null,\r\n              }}\r\n            >\r\n              <Row>\r\n                <Col flex=\"auto\">{name}</Col>\r\n                {selectedMarket !== address && (\r\n                  <Col>\r\n                    <DeleteOutlined\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        e.nativeEvent.stopImmediatePropagation();\r\n                        onDeleteCustomMarket && onDeleteCustomMarket(address);\r\n                      }}\r\n                    />\r\n                  </Col>\r\n                )}\r\n              </Row>\r\n            </Option>\r\n          ))}\r\n        </OptGroup>\r\n      )}\r\n      <OptGroup label=\"Markets\">\r\n        {uniqueArray(markets).map(({ address, name, deprecated }, i) => (\r\n          <Option\r\n            value={address.toBase58()}\r\n            key={nanoid()}\r\n            name={name}\r\n            style={{\r\n              padding: '10px',\r\n              // @ts-ignore\r\n              backgroundColor: i % 2 === 0 ? 'rgb(39, 44, 61)' : null,\r\n            }}\r\n          >\r\n            {name} {deprecated ? ' (Deprecated)' : null}\r\n          </Option>\r\n        ))}\r\n      </OptGroup>\r\n    </Select>\r\n  );\r\n}\r\n\r\nconst DeprecatedMarketsPage = ({ switchToLiveMarkets }) => {\r\n  return (\r\n    <>\r\n      <Row>\r\n        <Col flex=\"auto\">\r\n          <DeprecatedMarketsInstructions\r\n            switchToLiveMarkets={switchToLiveMarkets}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n};\r\n\r\nconst RenderNormal = ({ onChangeOrderRef, onPrice, onSize }) => {\r\n  return (\r\n    <Row\r\n      style={{\r\n        flexWrap: 'nowrap',\r\n      }}\r\n    >\r\n      <Col\r\n        flex=\"auto\"\r\n        style={{\r\n          height: '100vh',\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          border: '1px solid #9945FF',\r\n          marginRight: '15px',\r\n        }}\r\n      >\r\n        <TVChartContainer />\r\n        <UserInfoTable smallScreen={false} />\r\n      </Col>\r\n\r\n      <Col\r\n        flex=\"15%\"\r\n        style={{\r\n          height: '100vh',\r\n          minWidth: '280px',\r\n          border: '1px solid #9945FF',\r\n          marginRight: '15px',\r\n          overflow: 'hidden',\r\n        }}\r\n      >\r\n        <Orderbook smallScreen={false} onPrice={onPrice} onSize={onSize} />\r\n        <TradesTable smallScreen={false} />\r\n      </Col>\r\n      <Col\r\n        flex=\"400px\"\r\n        style={{\r\n          height: '100vh',\r\n          border: '1px solid #9945FF',\r\n          padding: '5px',\r\n          overflow: 'hidden',\r\n        }}\r\n      >\r\n        <TradeForm setChangeOrderRef={onChangeOrderRef} />\r\n        <StandaloneBalancesDisplay />\r\n      </Col>\r\n    </Row>\r\n  );\r\n};\r\n\r\nconst RenderSmaller = ({ onChangeOrderRef, onPrice, onSize }) => {\r\n  return (\r\n    <>\r\n      <Row>\r\n        <Col span={24}>\r\n          <TVChartContainer />\r\n        </Col>\r\n\r\n        <Col span={16}>\r\n          <TradeForm setChangeOrderRef={onChangeOrderRef} />\r\n        </Col>\r\n        <Col span={8}>\r\n          <Orderbook smallScreen={true} onPrice={onPrice} onSize={onSize} />\r\n        </Col>\r\n\r\n        <Col span={24}>\r\n          <UserInfoTable smallScreen={true} />\r\n        </Col>\r\n\r\n        <Col xs={24} sm={12}>\r\n          <StandaloneBalancesDisplay />\r\n        </Col>\r\n        <Col xs={24} sm={12}>\r\n          <TradesTable smallScreen={false} />\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}