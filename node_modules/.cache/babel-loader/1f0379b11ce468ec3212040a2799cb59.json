{"ast":null,"code":"var _jsxFileName = \"/home/dev/Code/dex-ui/src/components/TopBar.tsx\";\nimport { InfoCircleOutlined, PlusCircleOutlined, SettingOutlined } from '@ant-design/icons';\nimport { Button, Col, Menu, Popover, Row, Select } from 'antd';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { useWallet } from '../utils/wallet';\nimport { ENDPOINTS, useConnectionConfig } from '../utils/connection';\nimport Settings from './Settings';\nimport CustomClusterEndpointDialog from './CustomClusterEndpointDialog';\nimport { notify } from '../utils/notifications';\nimport { Connection } from '@solana/web3.js';\nimport WalletConnect from './WalletConnect';\nimport { getTradePageUrl } from '../utils/markets';\nconst Wrapper = styled.div`\n  background-color: #0d1017;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  padding: 0px 30px;\n  flex-wrap: wrap;\n`;\nconst LogoWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  color: #14f195;\n  font-weight: bold;\n  cursor: pointer;\n  img {\n    height: 30px;\n    margin-right: 8px;\n  }\n`;\nconst EXTERNAL_LINKS = {\n  '/learn': 'https://docs.projectserum.com/trade-on-serum-dex/trade-on-serum-dex-1',\n  '/add-market': 'https://serum-academy.com/en/add-market/',\n  '/wallet-support': 'https://serum-academy.com/en/wallet-support',\n  '/dex-list': 'https://serum-academy.com/en/dex-list/',\n  '/developer-resources': 'https://serum-academy.com/en/developer-resources/',\n  '/explorer': 'https://solscan.io',\n  '/srm-faq': 'https://projectserum.com/srm-faq',\n  '/swap': 'https://krk.finance/swap'\n};\nexport default function TopBar() {\n  const {\n    connected,\n    wallet\n  } = useWallet();\n  const {\n    endpoint,\n    endpointInfo,\n    setEndpoint,\n    availableEndpoints,\n    setCustomEndpoints\n  } = useConnectionConfig();\n  const [addEndpointVisible, setAddEndpointVisible] = useState(false);\n  const [testingConnection, setTestingConnection] = useState(false);\n  const location = useLocation();\n  const history = useHistory();\n  const [searchFocussed, setSearchFocussed] = useState(false);\n  const handleClick = useCallback(e => {\n    if (!(e.key in EXTERNAL_LINKS)) {\n      history.push(e.key);\n    }\n  }, [history]);\n\n  const onAddCustomEndpoint = info => {\n    const existingEndpoint = availableEndpoints.some(e => e.endpoint === info.endpoint);\n\n    if (existingEndpoint) {\n      notify({\n        message: `An endpoint with the given url already exists`,\n        type: 'error'\n      });\n      return;\n    }\n\n    const handleError = e => {\n      console.log(`Connection to ${info.endpoint} failed: ${e}`);\n      notify({\n        message: `Failed to connect to ${info.endpoint}`,\n        type: 'error'\n      });\n    };\n\n    try {\n      const connection = new Connection(info.endpoint, 'recent');\n      connection.getBlockTime(0).then(() => {\n        setTestingConnection(true);\n        console.log(`testing connection to ${info.endpoint}`);\n        const newCustomEndpoints = [...availableEndpoints.filter(e => e.custom), info];\n        setEndpoint(info.endpoint);\n        setCustomEndpoints(newCustomEndpoints);\n      }).catch(handleError);\n    } catch (e) {\n      handleError(e);\n    } finally {\n      setTestingConnection(false);\n    }\n  };\n\n  const endpointInfoCustom = endpointInfo && endpointInfo.custom;\n  useEffect(() => {\n    const handler = () => {\n      if (endpointInfoCustom) {\n        setEndpoint(ENDPOINTS[0].endpoint);\n      }\n    };\n\n    window.addEventListener('beforeunload', handler);\n    return () => window.removeEventListener('beforeunload', handler);\n  }, [endpointInfoCustom, setEndpoint]);\n  const tradePageUrl = location.pathname.startsWith('/market/') ? location.pathname : getTradePageUrl();\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CustomClusterEndpointDialog, {\n    visible: addEndpointVisible,\n    testingConnection: testingConnection,\n    onAddCustomEndpoint: onAddCustomEndpoint,\n    onClose: () => setAddEndpointVisible(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Wrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(LogoWrapper, {\n    onClick: () => history.push(tradePageUrl),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, 'KRK.FINANCE'), /*#__PURE__*/React.createElement(Menu, {\n    mode: \"horizontal\",\n    onClick: handleClick,\n    selectedKeys: [location.pathname],\n    style: {\n      borderBottom: 'none',\n      backgroundColor: 'transparent',\n      display: 'flex',\n      alignItems: 'flex-end',\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Menu.Item, {\n    key: tradePageUrl,\n    style: {\n      margin: '0 10px 0 20px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }, \"TRADE\"), !searchFocussed && /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"/swap\",\n    style: {\n      margin: '0 10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: EXTERNAL_LINKS['/swap'],\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 15\n    }\n  }, \"SWAP\")), connected && (!searchFocussed || location.pathname === '/balances') && /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"/balances\",\n    style: {\n      margin: '0 10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, \"BALANCES\"), connected && (!searchFocussed || location.pathname === '/orders') && /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"/orders\",\n    style: {\n      margin: '0 10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }\n  }, \"ORDERS\"), connected && (!searchFocussed || location.pathname === '/convert') && /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"/convert\",\n    style: {\n      margin: '0 10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, \"CONVERT\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      paddingRight: 5\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    align: \"middle\",\n    style: {\n      paddingLeft: 5,\n      paddingRight: 5\n    },\n    gutter: 16,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(PlusCircleOutlined, {\n    style: {\n      color: '#14F195'\n    },\n    onClick: () => setAddEndpointVisible(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Popover, {\n    content: endpoint,\n    placement: \"bottomRight\",\n    title: \"URL\",\n    trigger: \"hover\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(InfoCircleOutlined, {\n    style: {\n      color: '#14F195'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Select, {\n    onSelect: setEndpoint,\n    value: endpoint,\n    style: {\n      marginRight: 8,\n      width: '150px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 15\n    }\n  }, availableEndpoints.map(({\n    name,\n    endpoint\n  }) => /*#__PURE__*/React.createElement(Select.Option, {\n    value: endpoint,\n    key: endpoint,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 19\n    }\n  }, name)))))), connected && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Popover, {\n    content: /*#__PURE__*/React.createElement(Settings, {\n      autoApprove: wallet === null || wallet === void 0 ? void 0 : wallet.autoApprove,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 24\n      }\n    }),\n    placement: \"bottomRight\",\n    title: \"Settings\",\n    trigger: \"click\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(SettingOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 17\n    }\n  }), \"Settings\"))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(WalletConnect, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 11\n    }\n  }))));\n}","map":{"version":3,"sources":["/home/dev/Code/dex-ui/src/components/TopBar.tsx"],"names":["InfoCircleOutlined","PlusCircleOutlined","SettingOutlined","Button","Col","Menu","Popover","Row","Select","React","useCallback","useEffect","useState","useHistory","useLocation","styled","useWallet","ENDPOINTS","useConnectionConfig","Settings","CustomClusterEndpointDialog","notify","Connection","WalletConnect","getTradePageUrl","Wrapper","div","LogoWrapper","EXTERNAL_LINKS","TopBar","connected","wallet","endpoint","endpointInfo","setEndpoint","availableEndpoints","setCustomEndpoints","addEndpointVisible","setAddEndpointVisible","testingConnection","setTestingConnection","location","history","searchFocussed","setSearchFocussed","handleClick","e","key","push","onAddCustomEndpoint","info","existingEndpoint","some","message","type","handleError","console","log","connection","getBlockTime","then","newCustomEndpoints","filter","custom","catch","endpointInfoCustom","handler","window","addEventListener","removeEventListener","tradePageUrl","pathname","startsWith","borderBottom","backgroundColor","display","alignItems","flex","margin","paddingRight","paddingLeft","color","marginRight","width","map","name","autoApprove"],"mappings":";AAAA,SACEA,kBADF,EAEEC,kBAFF,EAGEC,eAHF,QAIO,mBAJP;AAKA,SAASC,MAAT,EAAiBC,GAAjB,EAAsBC,IAAtB,EAA4BC,OAA5B,EAAqCC,GAArC,EAA0CC,MAA1C,QAAwD,MAAxD;AACA,OAAOC,KAAP,IAAgBC,WAAhB,EAA6BC,SAA7B,EAAwCC,QAAxC,QAAwD,OAAxD;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,kBAAxC;AAEA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,SAAT,QAA0B,iBAA1B;AACA,SAASC,SAAT,EAAoBC,mBAApB,QAA+C,qBAA/C;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,2BAAP,MAAwC,+BAAxC;AAEA,SAASC,MAAT,QAAuB,wBAAvB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,SAASC,eAAT,QAAgC,kBAAhC;AAEA,MAAMC,OAAO,GAAGV,MAAM,CAACW,GAAI;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,CAPA;AAQA,MAAMC,WAAW,GAAGZ,MAAM,CAACW,GAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAVA;AAYA,MAAME,cAAc,GAAG;AACrB,YACE,uEAFmB;AAGrB,iBAAe,0CAHM;AAIrB,qBAAmB,6CAJE;AAKrB,eAAa,wCALQ;AAMrB,0BAAwB,mDANH;AAOrB,eAAa,oBAPQ;AAQrB,cAAY,kCARS;AASrB,WAAS;AATY,CAAvB;AAYA,eAAe,SAASC,MAAT,GAAkB;AAC/B,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAAwBf,SAAS,EAAvC;AACA,QAAM;AACJgB,IAAAA,QADI;AAEJC,IAAAA,YAFI;AAGJC,IAAAA,WAHI;AAIJC,IAAAA,kBAJI;AAKJC,IAAAA;AALI,MAMFlB,mBAAmB,EANvB;AAOA,QAAM,CAACmB,kBAAD,EAAqBC,qBAArB,IAA8C1B,QAAQ,CAAC,KAAD,CAA5D;AACA,QAAM,CAAC2B,iBAAD,EAAoBC,oBAApB,IAA4C5B,QAAQ,CAAC,KAAD,CAA1D;AACA,QAAM6B,QAAQ,GAAG3B,WAAW,EAA5B;AACA,QAAM4B,OAAO,GAAG7B,UAAU,EAA1B;AACA,QAAM,CAAC8B,cAAD,EAAiBC,iBAAjB,IAAsChC,QAAQ,CAAC,KAAD,CAApD;AAEA,QAAMiC,WAAW,GAAGnC,WAAW,CAC5BoC,CAAD,IAAO;AACL,QAAI,EAAEA,CAAC,CAACC,GAAF,IAASnB,cAAX,CAAJ,EAAgC;AAC9Bc,MAAAA,OAAO,CAACM,IAAR,CAAaF,CAAC,CAACC,GAAf;AACD;AACF,GAL4B,EAM7B,CAACL,OAAD,CAN6B,CAA/B;;AASA,QAAMO,mBAAmB,GAAIC,IAAD,IAAwB;AAClD,UAAMC,gBAAgB,GAAGhB,kBAAkB,CAACiB,IAAnB,CACtBN,CAAD,IAAOA,CAAC,CAACd,QAAF,KAAekB,IAAI,CAAClB,QADJ,CAAzB;;AAGA,QAAImB,gBAAJ,EAAsB;AACpB9B,MAAAA,MAAM,CAAC;AACLgC,QAAAA,OAAO,EAAG,+CADL;AAELC,QAAAA,IAAI,EAAE;AAFD,OAAD,CAAN;AAIA;AACD;;AAED,UAAMC,WAAW,GAAIT,CAAD,IAAO;AACzBU,MAAAA,OAAO,CAACC,GAAR,CAAa,iBAAgBP,IAAI,CAAClB,QAAS,YAAWc,CAAE,EAAxD;AACAzB,MAAAA,MAAM,CAAC;AACLgC,QAAAA,OAAO,EAAG,wBAAuBH,IAAI,CAAClB,QAAS,EAD1C;AAELsB,QAAAA,IAAI,EAAE;AAFD,OAAD,CAAN;AAID,KAND;;AAQA,QAAI;AACF,YAAMI,UAAU,GAAG,IAAIpC,UAAJ,CAAe4B,IAAI,CAAClB,QAApB,EAA8B,QAA9B,CAAnB;AACA0B,MAAAA,UAAU,CACPC,YADH,CACgB,CADhB,EAEGC,IAFH,CAEQ,MAAM;AACVpB,QAAAA,oBAAoB,CAAC,IAAD,CAApB;AACAgB,QAAAA,OAAO,CAACC,GAAR,CAAa,yBAAwBP,IAAI,CAAClB,QAAS,EAAnD;AACA,cAAM6B,kBAAkB,GAAG,CACzB,GAAG1B,kBAAkB,CAAC2B,MAAnB,CAA2BhB,CAAD,IAAOA,CAAC,CAACiB,MAAnC,CADsB,EAEzBb,IAFyB,CAA3B;AAIAhB,QAAAA,WAAW,CAACgB,IAAI,CAAClB,QAAN,CAAX;AACAI,QAAAA,kBAAkB,CAACyB,kBAAD,CAAlB;AACD,OAXH,EAYGG,KAZH,CAYST,WAZT;AAaD,KAfD,CAeE,OAAOT,CAAP,EAAU;AACVS,MAAAA,WAAW,CAACT,CAAD,CAAX;AACD,KAjBD,SAiBU;AACRN,MAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD;AACF,GAxCD;;AA0CA,QAAMyB,kBAAkB,GAAGhC,YAAY,IAAIA,YAAY,CAAC8B,MAAxD;AACApD,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMuD,OAAO,GAAG,MAAM;AACpB,UAAID,kBAAJ,EAAwB;AACtB/B,QAAAA,WAAW,CAACjB,SAAS,CAAC,CAAD,CAAT,CAAae,QAAd,CAAX;AACD;AACF,KAJD;;AAKAmC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,cAAxB,EAAwCF,OAAxC;AACA,WAAO,MAAMC,MAAM,CAACE,mBAAP,CAA2B,cAA3B,EAA2CH,OAA3C,CAAb;AACD,GARQ,EAQN,CAACD,kBAAD,EAAqB/B,WAArB,CARM,CAAT;AAUA,QAAMoC,YAAY,GAAG7B,QAAQ,CAAC8B,QAAT,CAAkBC,UAAlB,CAA6B,UAA7B,IACjB/B,QAAQ,CAAC8B,QADQ,GAEjB/C,eAAe,EAFnB;AAIA,sBACE,uDACE,oBAAC,2BAAD;AACE,IAAA,OAAO,EAAEa,kBADX;AAEE,IAAA,iBAAiB,EAAEE,iBAFrB;AAGE,IAAA,mBAAmB,EAAEU,mBAHvB;AAIE,IAAA,OAAO,EAAE,MAAMX,qBAAqB,CAAC,KAAD,CAJtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAOE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,WAAD;AAAa,IAAA,OAAO,EAAE,MAAMI,OAAO,CAACM,IAAR,CAAasB,YAAb,CAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEG,aAFH,CADF,eAKE,oBAAC,IAAD;AACE,IAAA,IAAI,EAAC,YADP;AAEE,IAAA,OAAO,EAAEzB,WAFX;AAGE,IAAA,YAAY,EAAE,CAACJ,QAAQ,CAAC8B,QAAV,CAHhB;AAIE,IAAA,KAAK,EAAE;AACLE,MAAAA,YAAY,EAAE,MADT;AAELC,MAAAA,eAAe,EAAE,aAFZ;AAGLC,MAAAA,OAAO,EAAE,MAHJ;AAILC,MAAAA,UAAU,EAAE,UAJP;AAKLC,MAAAA,IAAI,EAAE;AALD,KAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAYE,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAEP,YAAhB;AAA8B,IAAA,KAAK,EAAE;AAAEQ,MAAAA,MAAM,EAAE;AAAV,KAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAZF,EAeG,CAACnC,cAAD,iBACC,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,OAAf;AAAuB,IAAA,KAAK,EAAE;AAAEmC,MAAAA,MAAM,EAAE;AAAV,KAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,IAAI,EAAElD,cAAc,CAAC,OAAD,CADtB;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,GAAG,EAAC,qBAHN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,CAhBJ,EA0BGE,SAAS,KAAK,CAACa,cAAD,IAAmBF,QAAQ,CAAC8B,QAAT,KAAsB,WAA9C,CAAT,iBACC,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,WAAf;AAA2B,IAAA,KAAK,EAAE;AAAEO,MAAAA,MAAM,EAAE;AAAV,KAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBA3BJ,EA+BGhD,SAAS,KAAK,CAACa,cAAD,IAAmBF,QAAQ,CAAC8B,QAAT,KAAsB,SAA9C,CAAT,iBACC,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,SAAf;AAAyB,IAAA,KAAK,EAAE;AAAEO,MAAAA,MAAM,EAAE;AAAV,KAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAhCJ,EAoCGhD,SAAS,KAAK,CAACa,cAAD,IAAmBF,QAAQ,CAAC8B,QAAT,KAAsB,UAA9C,CAAT,iBACC,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,UAAf;AAA0B,IAAA,KAAK,EAAE;AAAEO,MAAAA,MAAM,EAAE;AAAV,KAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eArCJ,CALF,eAoDE;AACE,IAAA,KAAK,EAAE;AACLH,MAAAA,OAAO,EAAE,MADJ;AAELC,MAAAA,UAAU,EAAE,QAFP;AAGLG,MAAAA,YAAY,EAAE;AAHT,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IApDF,eAkEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AACE,IAAA,KAAK,EAAC,QADR;AAEE,IAAA,KAAK,EAAE;AAAEC,MAAAA,WAAW,EAAE,CAAf;AAAkBD,MAAAA,YAAY,EAAE;AAAhC,KAFT;AAGE,IAAA,MAAM,EAAE,EAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,kBAAD;AACE,IAAA,KAAK,EAAE;AAAEE,MAAAA,KAAK,EAAE;AAAT,KADT;AAEE,IAAA,OAAO,EAAE,MAAM3C,qBAAqB,CAAC,IAAD,CAFtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CALF,eAWE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,OAAD;AACE,IAAA,OAAO,EAAEN,QADX;AAEE,IAAA,SAAS,EAAC,aAFZ;AAGE,IAAA,KAAK,EAAC,KAHR;AAIE,IAAA,OAAO,EAAC,OAJV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAME,oBAAC,kBAAD;AAAoB,IAAA,KAAK,EAAE;AAAEiD,MAAAA,KAAK,EAAE;AAAT,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CADF,CAXF,eAqBE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,QAAQ,EAAE/C,WADZ;AAEE,IAAA,KAAK,EAAEF,QAFT;AAGE,IAAA,KAAK,EAAE;AAAEkD,MAAAA,WAAW,EAAE,CAAf;AAAkBC,MAAAA,KAAK,EAAE;AAAzB,KAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKGhD,kBAAkB,CAACiD,GAAnB,CAAuB,CAAC;AAAEC,IAAAA,IAAF;AAAQrD,IAAAA;AAAR,GAAD,kBACtB,oBAAC,MAAD,CAAQ,MAAR;AAAe,IAAA,KAAK,EAAEA,QAAtB;AAAgC,IAAA,GAAG,EAAEA,QAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGqD,IADH,CADD,CALH,CADF,CArBF,CADF,CAlEF,EAuGGvD,SAAS,iBACR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,OAAD;AACE,IAAA,OAAO,eAAE,oBAAC,QAAD;AAAU,MAAA,WAAW,EAAEC,MAAF,aAAEA,MAAF,uBAAEA,MAAM,CAAEuD,WAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADX;AAEE,IAAA,SAAS,EAAC,aAFZ;AAGE,IAAA,KAAK,EAAC,UAHR;AAIE,IAAA,OAAO,EAAC,OAJV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAME,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAE;AAAEJ,MAAAA,WAAW,EAAE;AAAf,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,aANF,CADF,CAxGJ,eAsHE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAtHF,CAPF,CADF;AAoID","sourcesContent":["import {\r\n  InfoCircleOutlined,\r\n  PlusCircleOutlined,\r\n  SettingOutlined,\r\n} from '@ant-design/icons';\r\nimport { Button, Col, Menu, Popover, Row, Select } from 'antd';\r\nimport React, { useCallback, useEffect, useState } from 'react';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\nimport logo from '../assets/logo.svg';\r\nimport styled from 'styled-components';\r\nimport { useWallet } from '../utils/wallet';\r\nimport { ENDPOINTS, useConnectionConfig } from '../utils/connection';\r\nimport Settings from './Settings';\r\nimport CustomClusterEndpointDialog from './CustomClusterEndpointDialog';\r\nimport { EndpointInfo } from '../utils/types';\r\nimport { notify } from '../utils/notifications';\r\nimport { Connection } from '@solana/web3.js';\r\nimport WalletConnect from './WalletConnect';\r\nimport { getTradePageUrl } from '../utils/markets';\r\n\r\nconst Wrapper = styled.div`\r\n  background-color: #0d1017;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: flex-end;\r\n  padding: 0px 30px;\r\n  flex-wrap: wrap;\r\n`;\r\nconst LogoWrapper = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  color: #14f195;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  img {\r\n    height: 30px;\r\n    margin-right: 8px;\r\n  }\r\n`;\r\n\r\nconst EXTERNAL_LINKS = {\r\n  '/learn':\r\n    'https://docs.projectserum.com/trade-on-serum-dex/trade-on-serum-dex-1',\r\n  '/add-market': 'https://serum-academy.com/en/add-market/',\r\n  '/wallet-support': 'https://serum-academy.com/en/wallet-support',\r\n  '/dex-list': 'https://serum-academy.com/en/dex-list/',\r\n  '/developer-resources': 'https://serum-academy.com/en/developer-resources/',\r\n  '/explorer': 'https://solscan.io',\r\n  '/srm-faq': 'https://projectserum.com/srm-faq',\r\n  '/swap': 'https://krk.finance/swap',\r\n};\r\n\r\nexport default function TopBar() {\r\n  const { connected, wallet } = useWallet();\r\n  const {\r\n    endpoint,\r\n    endpointInfo,\r\n    setEndpoint,\r\n    availableEndpoints,\r\n    setCustomEndpoints,\r\n  } = useConnectionConfig();\r\n  const [addEndpointVisible, setAddEndpointVisible] = useState(false);\r\n  const [testingConnection, setTestingConnection] = useState(false);\r\n  const location = useLocation();\r\n  const history = useHistory();\r\n  const [searchFocussed, setSearchFocussed] = useState(false);\r\n\r\n  const handleClick = useCallback(\r\n    (e) => {\r\n      if (!(e.key in EXTERNAL_LINKS)) {\r\n        history.push(e.key);\r\n      }\r\n    },\r\n    [history],\r\n  );\r\n\r\n  const onAddCustomEndpoint = (info: EndpointInfo) => {\r\n    const existingEndpoint = availableEndpoints.some(\r\n      (e) => e.endpoint === info.endpoint,\r\n    );\r\n    if (existingEndpoint) {\r\n      notify({\r\n        message: `An endpoint with the given url already exists`,\r\n        type: 'error',\r\n      });\r\n      return;\r\n    }\r\n\r\n    const handleError = (e) => {\r\n      console.log(`Connection to ${info.endpoint} failed: ${e}`);\r\n      notify({\r\n        message: `Failed to connect to ${info.endpoint}`,\r\n        type: 'error',\r\n      });\r\n    };\r\n\r\n    try {\r\n      const connection = new Connection(info.endpoint, 'recent');\r\n      connection\r\n        .getBlockTime(0)\r\n        .then(() => {\r\n          setTestingConnection(true);\r\n          console.log(`testing connection to ${info.endpoint}`);\r\n          const newCustomEndpoints = [\r\n            ...availableEndpoints.filter((e) => e.custom),\r\n            info,\r\n          ];\r\n          setEndpoint(info.endpoint);\r\n          setCustomEndpoints(newCustomEndpoints);\r\n        })\r\n        .catch(handleError);\r\n    } catch (e) {\r\n      handleError(e);\r\n    } finally {\r\n      setTestingConnection(false);\r\n    }\r\n  };\r\n\r\n  const endpointInfoCustom = endpointInfo && endpointInfo.custom;\r\n  useEffect(() => {\r\n    const handler = () => {\r\n      if (endpointInfoCustom) {\r\n        setEndpoint(ENDPOINTS[0].endpoint);\r\n      }\r\n    };\r\n    window.addEventListener('beforeunload', handler);\r\n    return () => window.removeEventListener('beforeunload', handler);\r\n  }, [endpointInfoCustom, setEndpoint]);\r\n\r\n  const tradePageUrl = location.pathname.startsWith('/market/')\r\n    ? location.pathname\r\n    : getTradePageUrl();\r\n\r\n  return (\r\n    <>\r\n      <CustomClusterEndpointDialog\r\n        visible={addEndpointVisible}\r\n        testingConnection={testingConnection}\r\n        onAddCustomEndpoint={onAddCustomEndpoint}\r\n        onClose={() => setAddEndpointVisible(false)}\r\n      />\r\n      <Wrapper>\r\n        <LogoWrapper onClick={() => history.push(tradePageUrl)}>\r\n          {/* <img src={logo} alt=\"\" /> */}\r\n          {'KRK.FINANCE'}\r\n        </LogoWrapper>\r\n        <Menu\r\n          mode=\"horizontal\"\r\n          onClick={handleClick}\r\n          selectedKeys={[location.pathname]}\r\n          style={{\r\n            borderBottom: 'none',\r\n            backgroundColor: 'transparent',\r\n            display: 'flex',\r\n            alignItems: 'flex-end',\r\n            flex: 1,\r\n          }}\r\n        >\r\n          <Menu.Item key={tradePageUrl} style={{ margin: '0 10px 0 20px' }}>\r\n            TRADE\r\n          </Menu.Item>\r\n          {!searchFocussed && (\r\n            <Menu.Item key=\"/swap\" style={{ margin: '0 10px' }}>\r\n              <a\r\n                href={EXTERNAL_LINKS['/swap']}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                SWAP\r\n              </a>\r\n            </Menu.Item>\r\n          )}\r\n          {connected && (!searchFocussed || location.pathname === '/balances') && (\r\n            <Menu.Item key=\"/balances\" style={{ margin: '0 10px' }}>\r\n              BALANCES\r\n            </Menu.Item>\r\n          )}\r\n          {connected && (!searchFocussed || location.pathname === '/orders') && (\r\n            <Menu.Item key=\"/orders\" style={{ margin: '0 10px' }}>\r\n              ORDERS\r\n            </Menu.Item>\r\n          )}\r\n          {connected && (!searchFocussed || location.pathname === '/convert') && (\r\n            <Menu.Item key=\"/convert\" style={{ margin: '0 10px' }}>\r\n              CONVERT\r\n            </Menu.Item>\r\n          )}\r\n          {/* {(!searchFocussed || location.pathname === '/list-new-market') && (\r\n            <Menu.Item key=\"/list-new-market\" style={{ margin: '0 10px' }}>\r\n              ADD MARKET\r\n            </Menu.Item>\r\n          )} */}\r\n        </Menu>\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            paddingRight: 5,\r\n          }}\r\n        >\r\n          {/* <AppSearch\r\n            onFocus={() => setSearchFocussed(true)}\r\n            onBlur={() => setSearchFocussed(false)}\r\n            focussed={searchFocussed}\r\n            width={searchFocussed ? '350px' : '35px'}\r\n          /> */}\r\n        </div>\r\n        <div>\r\n          <Row\r\n            align=\"middle\"\r\n            style={{ paddingLeft: 5, paddingRight: 5 }}\r\n            gutter={16}\r\n          >\r\n            <Col>\r\n              <PlusCircleOutlined\r\n                style={{ color: '#14F195' }}\r\n                onClick={() => setAddEndpointVisible(true)}\r\n              />\r\n            </Col>\r\n            <Col>\r\n              <Popover\r\n                content={endpoint}\r\n                placement=\"bottomRight\"\r\n                title=\"URL\"\r\n                trigger=\"hover\"\r\n              >\r\n                <InfoCircleOutlined style={{ color: '#14F195' }} />\r\n              </Popover>\r\n            </Col>\r\n            <Col>\r\n              <Select\r\n                onSelect={setEndpoint}\r\n                value={endpoint}\r\n                style={{ marginRight: 8, width: '150px' }}\r\n              >\r\n                {availableEndpoints.map(({ name, endpoint }) => (\r\n                  <Select.Option value={endpoint} key={endpoint}>\r\n                    {name}\r\n                  </Select.Option>\r\n                ))}\r\n              </Select>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n        {connected && (\r\n          <div>\r\n            <Popover\r\n              content={<Settings autoApprove={wallet?.autoApprove} />}\r\n              placement=\"bottomRight\"\r\n              title=\"Settings\"\r\n              trigger=\"click\"\r\n            >\r\n              <Button style={{ marginRight: 8 }}>\r\n                <SettingOutlined />\r\n                Settings\r\n              </Button>\r\n            </Popover>\r\n          </div>\r\n        )}\r\n        <div>\r\n          <WalletConnect />\r\n        </div>\r\n      </Wrapper>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}